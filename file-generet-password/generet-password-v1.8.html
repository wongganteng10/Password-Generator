<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Password Generator</title>
    <style>
        :root {
            --primary-color: #4CAF50;
            --primary-hover: #45a049;
            --save-color: #2196F3;
            --save-hover: #0b7dda;
            --copy-color: #9c27b0;
            --copy-hover: #7b1fa2;
            --export-color: #673ab7;
            --export-hover: #5e35b1;
            --weak-color: #ff4d4d;
            --medium-color: #ffa64d;
            --strong-color: #66cc66;
            --very-strong-color: #4d94ff;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            padding: 30px;
            width: 100%;
            max-width: 450px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 28px;
        }
        
        .password-display {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            font-size: 18px;
            word-break: break-all;
            position: relative;
            min-height: 80px;
            transition: all 0.3s ease;
        }
        
        .password-display:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .copy-btn {
            position: absolute;
            right: 15px;
            top: 15px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 6px 12px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s ease;
        }
        
        .copy-btn:hover {
            background-color: var(--primary-hover);
            transform: translateY(-1px);
        }
        
        .copy-btn:active {
            transform: translateY(0);
        }
        
        .controls {
            margin-bottom: 25px;
            text-align: left;
        }
        
        .control-group {
            margin-bottom: 18px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }
        
        .length-control {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        input[type="range"] {
            flex-grow: 1;
            height: 8px;
            -webkit-appearance: none;
            background: #e0e0e0;
            border-radius: 4px;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }
        
        input[type="number"] {
            width: 80px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-align: center;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input[type="number"]:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }
        
        input[type="checkbox"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            accent-color: var(--primary-color);
            cursor: pointer;
        }
        
        .checkbox-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 5px 0;
            transition: all 0.2s;
        }
        
        .checkbox-label:hover {
            color: var(--primary-hover);
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
        }
        
        .generate-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 14px 20px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .save-btn {
            background-color: var(--save-color);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 14px 20px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .export-btn {
            background-color: var(--export-color);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 14px 20px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: all 0.3s;
        }
        
        .generate-btn:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .save-btn:hover {
            background-color: var(--save-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .export-btn:hover {
            background-color: var(--export-hover);
            transform: translateY(-2px);
        }
        
        .generate-btn:active, .save-btn:active, .export-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 3px rgba(0, 0, 0, 0.1);
        }
        
        .strength-container {
            margin-top: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .strength-meter {
            flex-grow: 1;
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .strength-bar {
            height: 100%;
            width: 0%;
            transition: width 0.5s ease, background-color 0.5s ease;
        }
        
        .strength-text {
            font-size: 14px;
            font-weight: 600;
            min-width: 80px;
            text-align: right;
        }
        
        .warning {
            color: var(--weak-color);
            font-size: 13px;
            margin-top: 5px;
            display: none;
            animation: fadeIn 0.3s;
        }
        
        .loading {
            position: relative;
            color: #7f8c8d;
        }
        
        .loading::after {
            content: "...";
            position: absolute;
            animation: dots 1.5s infinite steps(3, end);
        }
        
        .saved-passwords {
            margin-top: 20px;
            text-align: left;
        }
        
        .saved-passwords h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .saved-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            background-color: #f9f9f9;
        }
        
        .saved-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .saved-item:last-child {
            border-bottom: none;
        }
        
        .saved-password {
            flex-grow: 1;
            word-break: break-all;
            padding-right: 10px;
        }
        
        .saved-actions {
            display: flex;
            gap: 5px;
        }
        
        .copy-saved-btn {
            background-color: var(--copy-color);
            color: white;
            border: none;
            border-radius: 3px;
            padding: 3px 8px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }
        
        .copy-saved-btn:hover {
            background-color: var(--copy-hover);
        }
        
        .delete-btn {
            background-color: #ff4d4d;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 3px 8px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }
        
        .delete-btn:hover {
            background-color: #e53935;
        }
        
        .empty-saved {
            color: #7f8c8d;
            font-style: italic;
            text-align: center;
            padding: 10px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes dots {
            0%, 20% { content: "."; }
            40% { content: ".."; }
            60%, 100% { content: "..."; }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .length-control {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            input[type="number"] {
                width: 100%;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .saved-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .saved-actions {
                margin-top: 5px;
                align-self: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ultimate Password Generator</h1>
        
        <div class="password-display" id="password">
            <span id="password-text">Your password will appear here</span>
            <button class="copy-btn" id="copy-btn">Copy</button>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label for="length">Password Length:</label>
                <div class="length-control">
                    <input type="range" id="length-slider" min="1" value="16" step="1">
                    <input type="number" id="length-input" min="1" value="16" step="1">
                </div>
                <div class="warning" id="length-warning">Very long passwords may impact performance</div>
            </div>
            
            <div class="control-group">
                <label>Character Types:</label>
                <label class="checkbox-label">
                    <input type="checkbox" id="uppercase" checked>
                    Uppercase Letters (A-Z)
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="lowercase" checked>
                    Lowercase Letters (a-z)
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="numbers" checked>
                    Numbers (0-9)
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="symbols" checked>
                    Symbols (!@#$%^&*)
                </label>
            </div>
            
            <div class="control-group">
                <label>Password Strength:</label>
                <div class="strength-container">
                    <div class="strength-meter">
                        <div class="strength-bar" id="strength-bar"></div>
                    </div>
                    <div class="strength-text" id="strength-text">Medium</div>
                </div>
            </div>
        </div>
        
        <div class="btn-group">
            <button class="generate-btn" id="generate-btn">Generate Password</button>
            <button class="save-btn" id="save-btn">Save Password</button>
        </div>
        
        <button class="export-btn" id="export-btn">Export to Saved-Passwords.txt</button>
        
        <div class="saved-passwords" id="saved-passwords">
            <h3>Saved Passwords</h3>
            <div class="saved-list" id="saved-list">
                <div class="empty-saved">No passwords saved yet</div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const lengthSlider = document.getElementById('length-slider');
            const lengthInput = document.getElementById('length-input');
            const lengthWarning = document.getElementById('length-warning');
            const uppercaseCheckbox = document.getElementById('uppercase');
            const lowercaseCheckbox = document.getElementById('lowercase');
            const numbersCheckbox = document.getElementById('numbers');
            const symbolsCheckbox = document.getElementById('symbols');
            const generateBtn = document.getElementById('generate-btn');
            const saveBtn = document.getElementById('save-btn');
            const exportBtn = document.getElementById('export-btn');
            const passwordText = document.getElementById('password-text');
            const passwordDisplay = document.getElementById('password');
            const copyBtn = document.getElementById('copy-btn');
            const strengthBar = document.getElementById('strength-bar');
            const strengthText = document.getElementById('strength-text');
            const savedList = document.getElementById('saved-list');
            
            // Character sets
            const charsets = {
                uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
                lowercase: 'abcdefghijklmnopqrstuvwxyz',
                numbers: '0123456789',
                symbols: '!@#$%^&*()_+-=[]{}|;:,.<>?'
            };
            
            // Initialize
            let isGenerating = false;
            let lastPassword = '';
            const MAX_SLIDER_VALUE = 100;
            lengthSlider.max = MAX_SLIDER_VALUE;
            
            // Load saved passwords from localStorage
            let savedPasswords = JSON.parse(localStorage.getItem('savedPasswords')) || [];
            renderSavedPasswords();
            
            // Event Listeners
            lengthSlider.addEventListener('input', handleLengthChange);
            
            lengthInput.addEventListener('input', function() {
                if (this.value === '') {
                    return;
                }
                
                let value = parseInt(this.value);
                if (isNaN(value)) {
                    value = 16;
                } else if (value < 1) {
                    value = 1;
                }
                
                this.value = value;
                lengthSlider.value = Math.min(value, MAX_SLIDER_VALUE);
                checkLengthWarning();
                
                if (!isGenerating) {
                    generatePassword();
                }
            });
            
            lengthInput.addEventListener('blur', function() {
                if (this.value === '') {
                    this.value = 16;
                    lengthSlider.value = 16;
                    generatePassword();
                }
            });
            
            [uppercaseCheckbox, lowercaseCheckbox, numbersCheckbox, symbolsCheckbox].forEach(checkbox => {
                checkbox.addEventListener('change', validateCharacterSets);
            });
            
            generateBtn.addEventListener('click', generatePassword);
            saveBtn.addEventListener('click', savePassword);
            exportBtn.addEventListener('click', exportToFile);
            copyBtn.addEventListener('click', copyToClipboard);
            passwordDisplay.addEventListener('click', handlePasswordDisplayClick);
            
            // Initial generation
            generatePassword();
            
            // Functions
            function handleLengthChange() {
                lengthInput.value = this.value;
                checkLengthWarning();
                if (!isGenerating) generatePassword();
            }
            
            function checkLengthWarning() {
                lengthWarning.style.display = parseInt(lengthInput.value) > 1000 ? 'block' : 'none';
            }
            
            function validateCharacterSets() {
                if (!uppercaseCheckbox.checked && 
                    !lowercaseCheckbox.checked && 
                    !numbersCheckbox.checked && 
                    !symbolsCheckbox.checked) {
                    
                    lowercaseCheckbox.checked = true;
                    
                    const warning = document.createElement('div');
                    warning.className = 'warning';
                    warning.textContent = 'At least one character type must be selected';
                    lowercaseCheckbox.parentNode.appendChild(warning);
                    
                    setTimeout(() => {
                        warning.remove();
                    }, 3000);
                }
                
                if (!isGenerating) generatePassword();
            }
            
            async function generatePassword() {
                if (isGenerating) return;
                
                isGenerating = true;
                generateBtn.disabled = true;
                
                const length = parseInt(lengthInput.value);
                const options = {
                    uppercase: uppercaseCheckbox.checked,
                    lowercase: lowercaseCheckbox.checked,
                    numbers: numbersCheckbox.checked,
                    symbols: symbolsCheckbox.checked
                };
                
                if (length > 10000) {
                    passwordText.textContent = 'Generating';
                    passwordText.classList.add('loading');
                    copyBtn.style.display = 'none';
                }
                
                try {
                    const password = await generatePasswordAsync(length, options);
                    lastPassword = password;
                    displayPassword(password);
                    updateStrengthIndicator(password);
                } catch (error) {
                    console.error('Password generation error:', error);
                    passwordText.textContent = 'Error generating password';
                } finally {
                    passwordText.classList.remove('loading');
                    generateBtn.disabled = false;
                    isGenerating = false;
                    copyBtn.style.display = '';
                }
            }
            
            function generatePasswordAsync(length, options) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const charset = buildCharset(options);
                        if (charset.length === 0) {
                            resolve('');
                            return;
                        }
                        
                        let password = '';
                        const charsetLength = charset.length;
                        
                        if (window.crypto && window.crypto.getRandomValues) {
                            const randomValues = new Uint32Array(length);
                            window.crypto.getRandomValues(randomValues);
                            
                            for (let i = 0; i < length; i++) {
                                password += charset[randomValues[i] % charsetLength];
                            }
                        } else {
                            for (let i = 0; i < length; i++) {
                                password += charset[Math.floor(Math.random() * charsetLength)];
                            }
                        }
                        
                        resolve(password);
                    }, 10);
                });
            }
            
            function buildCharset(options) {
                let charset = '';
                for (const [key, value] of Object.entries(charsets)) {
                    if (options[key]) charset += value;
                }
                return charset;
            }
            
            function displayPassword(password) {
                passwordText.textContent = password || 'Unable to generate password';
                
                if (password.length > 100) {
                    passwordDisplay.scrollTop = passwordDisplay.scrollHeight;
                }
            }
            
            function updateStrengthIndicator(password) {
                if (!password) {
                    strengthBar.style.width = '0%';
                    strengthText.textContent = 'None';
                    return;
                }
                
                let strength = calculatePasswordStrength(password);
                const percentage = Math.min(strength * 10, 100);
                
                strengthBar.style.width = percentage + '%';
                
                if (strength < 3) {
                    strengthBar.style.backgroundColor = 'var(--weak-color)';
                    strengthText.textContent = 'Weak';
                } else if (strength < 6) {
                    strengthBar.style.backgroundColor = 'var(--medium-color)';
                    strengthText.textContent = 'Medium';
                } else if (strength < 8) {
                    strengthBar.style.backgroundColor = 'var(--strong-color)';
                    strengthText.textContent = 'Strong';
                } else {
                    strengthBar.style.backgroundColor = 'var(--very-strong-color)';
                    strengthText.textContent = 'Very Strong';
                }
            }
            
            function calculatePasswordStrength(password) {
                let strength = 0;
                const length = password.length;
                
                strength += Math.min(Math.log(length) / Math.log(4) * 3, 6);
                
                const has = {
                    uppercase: /[A-Z]/.test(password),
                    lowercase: /[a-z]/.test(password),
                    numbers: /[0-9]/.test(password),
                    symbols: /[^A-Za-z0-9]/.test(password)
                };
                
                const varietyCount = Object.values(has).filter(Boolean).length;
                strength += (varietyCount - 1) * 0.5;
                
                if (has.uppercase && has.lowercase) strength += 0.5;
                if ((has.uppercase || has.lowercase) && has.numbers) strength += 0.5;
                if (has.symbols) strength += 0.5;
                
                return Math.min(strength, 10);
            }
            
            function copyToClipboard() {
                if (!lastPassword || lastPassword === 'Your password will appear here') {
                    return;
                }
                
                navigator.clipboard.writeText(lastPassword).then(() => {
                    copyBtn.textContent = 'Copied!';
                    setTimeout(() => {
                        copyBtn.textContent = 'Copy';
                    }, 2000);
                }).catch((err) => {
                    copyBtn.textContent = 'Failed!';
                    console.error('Copy failed:', err);
                    setTimeout(() => {
                        copyBtn.textContent = 'Copy';
                    }, 2000);
                });
            }
            
            function handlePasswordDisplayClick(e) {
                if (e.target !== passwordDisplay && e.target !== passwordText) return;
                if (lastPassword) {
                    copyToClipboard();
                }
            }
            
            function savePassword() {
                if (!lastPassword || lastPassword === 'Your password will appear here') {
                    alert('Please generate a password first');
                    return;
                }
                
                // Add timestamp to the saved password
                const timestamp = new Date().toLocaleString();
                const passwordEntry = {
                    password: lastPassword,
                    timestamp: timestamp
                };
                
                // Add to beginning of array (newest first)
                savedPasswords.unshift(passwordEntry);
                
                // Save to localStorage
                localStorage.setItem('savedPasswords', JSON.stringify(savedPasswords));
                
                // Update the displayed list
                renderSavedPasswords();
                
                // Visual feedback
                saveBtn.textContent = 'Saved!';
                setTimeout(() => {
                    saveBtn.textContent = 'Save Password';
                }, 2000);
            }
            
            function renderSavedPasswords() {
                savedList.innerHTML = '';
                
                if (savedPasswords.length === 0) {
                    savedList.innerHTML = '<div class="empty-saved">No passwords saved yet</div>';
                    return;
                }
                
                savedPasswords.forEach((item, index) => {
                    const passwordItem = document.createElement('div');
                    passwordItem.className = 'saved-item';
                    
                    const passwordSpan = document.createElement('span');
                    passwordSpan.className = 'saved-password';
                    passwordSpan.textContent = `${item.password} (${item.timestamp})`;
                    
                    const actionsDiv = document.createElement('div');
                    actionsDiv.className = 'saved-actions';
                    
                    const copyBtn = document.createElement('button');
                    copyBtn.className = 'copy-saved-btn';
                    copyBtn.textContent = 'Copy';
                    copyBtn.addEventListener('click', () => copySavedPassword(item.password, copyBtn));
                    
                    const deleteBtn = document.createElement('button');
                    deleteBtn.className = 'delete-btn';
                    deleteBtn.textContent = 'Delete';
                    deleteBtn.addEventListener('click', () => deletePassword(index));
                    
                    actionsDiv.appendChild(copyBtn);
                    actionsDiv.appendChild(deleteBtn);
                    passwordItem.appendChild(passwordSpan);
                    passwordItem.appendChild(actionsDiv);
                    savedList.appendChild(passwordItem);
                });
            }
            
            function copySavedPassword(password, buttonElement) {
                navigator.clipboard.writeText(password).then(() => {
                    // Reset all copy buttons first
                    document.querySelectorAll('.copy-saved-btn').forEach(btn => {
                        btn.textContent = 'Copy';
                    });
                    
                    // Update the clicked button
                    buttonElement.textContent = 'Copied!';
                    setTimeout(() => {
                        buttonElement.textContent = 'Copy';
                    }, 2000);
                }).catch((err) => {
                    console.error('Copy failed:', err);
                    buttonElement.textContent = 'Failed!';
                    setTimeout(() => {
                        buttonElement.textContent = 'Copy';
                    }, 2000);
                });
            }
            
            function deletePassword(index) {
                if (confirm('Are you sure you want to delete this password?')) {
                    savedPasswords.splice(index, 1);
                    localStorage.setItem('savedPasswords', JSON.stringify(savedPasswords));
                    renderSavedPasswords();
                }
            }
            
            function exportToFile() {
                if (savedPasswords.length === 0) {
                    alert('No passwords to export');
                    return;
                }
                
                // Format file content
                let fileContent = `Saved Passwords - Generated on ${new Date().toLocaleString()}\n\n`;
                fileContent += '==========================================\n\n';
                
                savedPasswords.forEach((item, index) => {
                    fileContent += `Password #${index + 1}:\n`;
                    fileContent += `Created: ${item.timestamp}\n`;
                    fileContent += `Password: ${item.password}\n\n`;
                    fileContent += '------------------------------------------\n\n';
                });
                
                fileContent += `Total Passwords: ${savedPasswords.length}\n`;
                fileContent += '==========================================';
                
                // Create Blob
                const blob = new Blob([fileContent], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                
                // Create download link
                const a = document.createElement('a');
                a.href = url;
                a.download = 'Saved-Passwords.txt';
                document.body.appendChild(a);
                a.click();
                
                // Clean up
                setTimeout(() => {
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 100);
                
                // Visual feedback
                exportBtn.textContent = 'Exported!';
                setTimeout(() => {
                    exportBtn.textContent = 'Export to Saved-Passwords.txt';
                }, 2000);
            }
        });
    </script>
</body>
</html>